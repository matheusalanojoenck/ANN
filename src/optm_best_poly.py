import numpy as np
from typing import List

def best_poly(x: List[float], y: List[float], k):
    A = []
    B = []
    k += 1
    n = len(x)

    for m in range(k):
        soma_xy = 0
        row = []
        for j in range(k):
            soma_x = 0
            for i in range(n):
                soma_x += x[i] ** (j+m)
            row.append(soma_x)
        for i in range(n):
            soma_xy += y[i]*(x[i] ** m)
        B.append(soma_xy)
        A.append(row)

    coeffs = np.linalg.solve(A, B)

    return coeffs

if __name__ == '__main__':
    pontos = {"x": [-4.2468, -4.2174, -4.1768, -4.1402, -4.1142, -4.0987, -4.0678, -4.0415, -4.0201, -3.9835, -3.9554, -3.9293, -3.8845, -3.8686, -3.8437, -3.799, -3.7914, -3.7629, -3.7199, -3.7024, -3.666, -3.6368, -3.6234, -3.5961, -3.5445, -3.5434, -3.4941, -3.4694, -3.4559, -3.4292, -3.386, -3.3483, -3.3224, -3.2942, -3.267, -3.2349, -3.2257, -3.1883, -3.1562, -3.1323, -3.0991, -3.0667, -3.0533, -3.0289, -2.9875, -2.9683, -2.9347, -2.9007, -2.8784, -2.8652, -2.8128, -2.7986, -2.7626, -2.74, -2.7215, -2.6687, -2.6652, -2.6317, -2.5906, -2.5627, -2.553, -2.5071, -2.4713, -2.4441, -2.4328, -2.4077, -2.3699, -2.3535, -2.3078, -2.2897, -2.2728, -2.2296, -2.1942, -2.1746, -2.1388, -2.1098, -2.0845, -2.0597, -2.0348, -2.0126, -1.9693, -1.9621, -1.9192, -1.8829, -1.8599, -1.8271, -1.7957, -1.7725, -1.7615, -1.7152, -1.6922, -1.6717, -1.6258, -1.6167, -1.5918, -1.5508, -1.5327, -1.496, -1.4658, -1.4512, -1.4252, -1.3925, -1.3471, -1.3299, -1.2915, -1.2598, -1.2381, -1.2205, -1.1764, -1.1648, -1.1388, -1.0879, -1.0773, -1.034, -1.0128, -0.9981, -0.9725, -0.9403, -0.9058, -0.8722, -0.8585, -0.817, -0.7848, -0.7576, -0.7405, -0.7011, -0.6875, -0.6417, -0.6176, -0.5847, -0.572, -0.5267, -0.4998, -0.4907, -0.444, -0.4103, -0.3989, -0.3703, -0.3459, -0.3079, -0.274, -0.25, -0.2205, -0.2037, -0.1597, -0.1407, -0.1074, -0.0914, -0.0531, -0.0397, -0.0033, 0.0334, 0.0699, 0.0816, 0.1204, 0.128, 0.1782, 0.2071, 0.2123, 0.2447, 0.2908, 0.313, 0.3524, 0.3761, 0.3861, 0.4263, 0.4503, 0.4813, 0.5178, 0.5418, 0.5549, 0.6, 0.6314, 0.6371, 0.6914, 0.7102, 0.7456, 0.7693, 0.782, 0.8266, 0.8542, 0.8761, 0.897, 0.9225, 0.9687, 0.9951, 1.006, 1.0469, 1.0756, 1.1062, 1.1194, 1.162, 1.1822, 1.2163, 1.252, 1.2719, 1.2953, 1.3198, 1.3554, 1.3806, 1.4052, 1.4452, 1.4706, 1.4899, 1.5301, 1.5567, 1.5886, 1.6002, 1.6281, 1.6674, 1.702, 1.7316, 1.7645, 1.7659, 1.8017, 1.8425, 1.864, 1.9055, 1.9237, 1.9477, 1.9666, 2.0035, 2.0219, 2.0528, 2.0873, 2.1244, 2.1398, 2.1631, 2.2067, 2.241, 2.2486, 2.2864, 2.3221, 2.3431, 2.3828, 2.4025, 2.4152, 2.4642, 2.474, 2.5061, 2.5508, 2.5735, 2.6117, 2.6218, 2.662, 2.6889, 2.7127, 2.7353, 2.7756, 2.7922, 2.8155, 2.8622, 2.882, 2.9017, 2.9425, 2.9715, 2.9864, 3.0357, 3.0638, 3.0772, 3.0984, 3.1379, 3.1678, 3.1936, 3.206, 3.2572, 3.2619, 3.3039, 3.3185, 3.361, 3.3775, 3.4056, 3.4375, 3.468, 3.5126, 3.5185, 3.5534, 3.5805, 3.601, 3.6298, 3.6705, 3.6947, 3.7211, 3.7573, 3.7703, 3.8093, 3.8378, 3.8759, 3.911, 3.9296, 3.9564, 3.971, 4.0177, 4.0424, 4.0584, 4.1039, 4.1263, 4.1547, 4.1735, 4.2039, 4.2312], "y": [2.8868, 3.5708, 3.0039, 3.8889, 4.3889, 4.2944, 4.574, 4.1159, 4.6944, 5.9582, 6.8626, 5.7655, 6.4737, 4.9149, 6.0328, 4.5149, 6.1809, 6.3049, 6.3911, 6.2684, 6.6572, 5.6009, 6.4879, 6.7475, 6.568, 6.5469, 6.9811, 6.9345, 6.8763, 6.7291, 7.057, 6.7191, 7.0352, 7.5078, 7.0802, 7.1541, 6.8095, 6.7463, 7.8118, 6.8795, 5.9699, 6.7449, 6.9843, 6.9179, 6.7561, 6.5506, 8.3815, 6.8022, 6.7513, 6.6173, 6.7412, 6.5882, 5.6017, 6.458, 6.4571, 6.2083, 6.4619, 6.003, 6.23, 5.9047, 5.8624, 5.7723, 6.0008, 5.8591, 7.011, 5.9672, 5.7928, 5.6368, 5.5941, 4.802, 5.2622, 5.4817, 5.7093, 5.1417, 4.2627, 5.2134, 5.2627, 5.2651, 4.9733, 6.1407, 4.76, 5.1722, 4.9021, 3.3666, 4.5701, 4.6546, 5.6835, 4.892, 5.4218, 4.441, 4.2886, 4.4226, 3.1374, 4.5285, 4.5177, 4.2841, 4.662, 3.4844, 4.4062, 3.5015, 4.5737, 4.3358, 4.2995, 4.2688, 4.3654, 5.9391, 4.7442, 4.6586, 3.7915, 4.054, 3.9896, 4.3372, 4.2388, 4.4062, 4.1695, 4.1257, 4.2246, 4.2333, 4.0752, 4.4276, 4.2954, 4.3922, 4.0298, 4.5085, 5.0291, 4.3443, 4.2969, 4.5959, 4.5339, 4.6683, 4.6402, 4.4567, 3.861, 4.7922, 4.615, 3.9104, 5.2665, 4.8192, 4.4421, 3.678, 4.8226, 4.5228, 4.8857, 4.7536, 4.88, 4.9418, 4.953, 4.8615, 5.0753, 5.5186, 4.7833, 4.9355, 4.8635, 5.3254, 4.915, 4.9312, 4.7842, 5.9414, 4.9847, 6.856, 4.8805, 5.2809, 5.35, 4.6383, 5.3008, 5.532, 6.0402, 6.4079, 5.4201, 5.6396, 4.7829, 5.4215, 5.6234, 5.6472, 5.5977, 7.5273, 5.6535, 5.6746, 5.7282, 6.2449, 5.8923, 5.8605, 5.7705, 5.8905, 6.227, 5.7521, 5.8937, 5.6978, 5.8551, 5.9114, 6.4898, 5.5908, 6.3958, 5.7425, 4.3293, 5.6216, 5.7033, 5.8274, 5.7632, 5.4885, 5.5226, 6.4904, 5.4385, 5.7002, 6.9138, 5.6719, 5.3836, 5.3048, 5.3005, 5.3401, 6.4008, 4.8066, 5.1955, 5.5801, 4.4988, 5.3006, 5.5927, 6.3337, 4.755, 6.8904, 5.2604, 4.9914, 4.5481, 4.7651, 4.9286, 5.3574, 4.5584, 4.5509, 4.4985, 4.7127, 4.638, 4.2674, 4.6436, 4.6154, 4.3424, 3.9231, 4.428, 5.7343, 4.2223, 3.8293, 4.6216, 5.6808, 3.7564, 3.799, 4.0802, 3.0227, 3.4364, 3.6814, 3.3359, 3.3364, 3.2668, 3.47, 3.457, 3.3134, 2.376, 3.4438, 3.4131, 2.6611, 3.8799, 3.1106, 4.3384, 3.0346, 3.1097, 2.9214, 2.8288, 4.5174, 3.1998, 3.0993, 2.9962, 3.0647, 3.1213, 3.1608, 3.3243, 2.8805, 3.6852, 4.4794, 3.2842, 3.5214, 3.2883, 1.886, 3.8283, 3.6342, 3.5987, 3.8874, 3.8827, 3.9926, 4.181, 4.2631, 4.3707, 4.7035, 4.6749, 5.4517, 4.9457, 5.1775, 5.5795, 5.7027, 6.0596, 6.2931, 6.0798, 6.9591, 6.9805]}
    x = pontos['x']
    y = pontos['y']
    k = 5
    coeffs = best_poly(x, y, k)
    print(list(coeffs))
